
<HTML> 
  <HEAD>
<!--Office of Information & Technology (OI&T)-->
<!--Oakland OIFO-->
<!--Authored by Thom Blom and Susan Strack, 01/01/01-->
<!--Revised by Thom Blom, 10/18/10-->
    <META HTTP-EQUIV="Content-Type"
          CONTENT="text/html; charset=iso-8859-1"> 
    <TITLE>Kernel Toolkit APIs: EN^XDRMERG</TITLE>
    <META NAME="subject"
          CONTENT="XTLKKWL^XTLKKWL: Perform Supported VA FileMan Calls on Files Configured for MTLU">
    <META NAME="keywords"
	      CONTENT="Infrastructure and Security Services,Information Infrastructure Service,ISS,IIS,VISTA,kernel,toolkit,programmer,developer,programmer manual,apis,application programming interface,application,programming,interface,entry point,$$DECODE^XTHCUTL,$$DECODE,XTHCUTL,http,supported">
    <LINK REL="StyleSheet"
          TYPE="text/css"
          HREF="common/programmer.css"> 
  </HEAD> 
  <BODY> 
<!--webbot bot="Include" U-Include="common/banner_api_page-toolkit.htm" TAG="BODY" startspan -->
<!--Title Banner (image)-->
    <TABLE BORDER="0"
           WIDTH="100%"
           CELLSPACING="0"
           CELLPADDING="6"
	       SUMMARY="This table is for formatting purposes only"
	       HEIGHT="65"> 
      <TR> 
	    <TD VALIGN="middle"
	        ALIGN="left"
	        HEIGHT="30"> 
		  <IMG SRC="images/toolkit_heading_APIs-new.gif"
			   ALT="Toolkit 7.3 APIs Banner"
			   BORDER="0" width="429" height="29">
		  <A HREF="#navskip">
		  <IMG SRC="images/clr_pxl.gif"
			   ALT="[skip navigation]"
			   WIDTH="25"
			   HEIGHT="1"
			   BORDER="0"></A>
		  <BR>
		  <IMG SRC="images/oitbanner.gif"
			   ALT="Office of Information & Technology (OIT) Banner"
			   BORDER="0" width="429" height="30">
			 </P>
		</TD> 
		<TD ALIGN="right"
		    VALIGN="middle"
		    HEIGHT="30"> 
		  <P></P>
        </TD> 
	  </TR> 
    </TABLE> 
  <!--webbot bot="Include" endspan i-checksum="4890" --><P></P> 
<!-- Content -->
    <H3><A NAME="navskip">EN^XDRMERG(): Merge File Entries</H3> 
	<P><B>Reference Type:</B> Supported, <B>Category:</B> Toolkit-Duplicate Record Merge,
	<B>Integration Agreement:</B> 2365</P> 
	<H4><A NAME="description">Description</A></H4> 
	<P>The EN^XDRMERG API provides for merging of one or more pairs of records in a specified file. This API takes two (2) arguments:

<UL>	<LI>File number (a numeric value). </LI>
	<LI>Closed reference to the location where the program finds an array with
subscripts indicating the record pairs to be merged (a text value). </LI></UL>
	</P>
	<H4><A NAME="format">Format</A></H4> 
	<PRE>D EN^XDRMERG(file,arraynam)</PRE>
	 <P><B>Input Parameters:</B>  </P>
        <UL>
        <P><B>file:</B> (required) Specifies the file number of the file in which the indicated entries are to be merged.</P>
	
	</UL>

	 <P><B>Input/Output Parameters</B> </P>
<UL><P><B>     arraynam:</B> 
	 (required) This parameter contains the name of the array as a closed root under which the subscripts indicating the FROM and TO entries are found. The data can have either two or four subscripts descendent from the array, which is passed.
	</P> </UL>
<UL>
REF: For examples of its usage, see the "Overview" section.
</UL>
<H4>
Examples
</H4>
<p>
The following command would result in record pairs specified as subscripts in the array MYLOC to be merged in a hypothetical file #999000014:
<PRE>  D EN^XDRMERG(999000014,"MYLOC")</PRE>
</P>
<P>
The array MYLOC might have been set up prior to this call in the following manner (or any equivalent way) where the subscripts represent the internal entry numbers of the FROM and TO records, respectively.
</P>
<UL>
S MYLOC(147,286)="",MYLOC(182,347)="",MYLOC(2047,192)=""</UL>
<UL>
   S MYLOC(837,492)="",MYLOC(298,299)=""
</UL>
<P>
This would result in five record pairs being merged with record 147 (the FROM record) being merged into record 286 (the TO record), record 182 being merged into record 347, etc., to record 298 being merged into 299. Merges using the two subscript format occurs without a specific record of the entries prior to the merge (The internal entry numbers merged would be recorded under the file number in XDR REPOINTED ENTRY [#15.3] file) An alternative is a four subscript format for the data array that uses VARIABLE POINTER formats for the FROM and TO records as the third and fourth subscripts. If the merge is performed with this four subscript array, then a pre-merge image of the data of both the FROM and TO records in the primary file and all other merged files (those related by DINUM) and information on all single value pointer values modified is stored in the MERGE IMAGE (#15.4) file.
</P>

<P>
 For the sample data above [assuming that the global root for the hypothetical File #999000014 is ^DIZ(999000014,] the four subscript array might be generated using the following code:
</P>


<UL><H4>
 EN^XDRMERG API-Example
</UL>
</H4>
















<P>
Exclusion of Multiple Pairs For a Record-To insure that there are no unanticipated problems due to relationships between a specific record in multiple merges, prior to actually merging any data the various FROM and TO records included in the process are examined, and if one record is involved in more than one merge, all except the first pair of records involving that one are excluded from the merge. If any pairs are excluded for this reason, a mail message is generated to the individual responsible for the merge process as indicated by the DUZ.
</P>
<P>
If the following entries were included in the MYLOC array:
</p>











<P>
Only the first of these entries (based on the numeric sorting of the array) would be permitted to remain in the merge process, while the other two pairs would be omitted). And although it may seem unlikely that someone would indicate that a record should be merged into two different locations, while another location should be merged into one that was merged away, if the pairs are selected automatically and checks are not included to prohibit such behavior, they show up. That is why the merge process does not include more than one pair with a specific record in it.
</P>

<H4>
Problems Related To Data Entry While Merging
</H4>
<P>
The Merge Process has been designed to combine data associated with the two records in the manner described above. On occasion, however, there are problems that cause VA FileMan to reject the data that is being entered. This may happen for a number of reasons. Some examples that have been observed include:
<UL>
<LI>
Clinics that had been changed so they no longer were indicated as Clinics (so they would not add to the number that people had to browse through to select a clinic), but were rejected since the input transform checked that they be clinics.
</LI>
<LI>
Pointer values that no longer had a valid value in the pointed to file (dangling pointers).
</LI>
<LI>
Fields that have input transforms that prohibit data entry.
</LI>
</UL>
<P>
It is possible to use a validity checker on your data prior to initiating the actual merge process (this is the action taken by merges working from the Potential Duplicate file). The data pairs are processed in a manner similar to the actual merge, so only that data in any of the files that would be merged and for which the data would be entered using VA FileMan utilities for the specific pair are checked to insure they pass the input transform. Any problems noted are incorporated into a mail message for resolution prior to attempting to merge the pair again, and the pair is removed from the data array that was passed in. Pairs that pass through this checking should not encounter any data problems while being merged.
</P>















	<P>&nbsp;</P>
	<HR COLOR="003399"> 
	<TABLE WIDTH="100%"
	       SUMMARY="This table for layout purposes only"
	       CLASS="white"> 
	  <TR> 
		<TD ALIGN="CENTER"
		    VALIGN="TOP"
		    COLSPAN="2">
<!--Bottom Navigation Links-->
<!--webbot bot="Include" U-Include="common/bottom_links.htm"
             TAG="BODY" startspan -->
    <P ALIGN="CENTER">
	<A HREF="http://www.va.gov/"
	   CLASS="bodylink"
	   TARGET="_top"
	   TITLE="Department of Veterans Affairs Internet Home Page">
	   <ACRONYM TITLE="Department of Veterans Affairs">VA</ACRONYM> (Internet)</A> /
				 
    <A HREF="http://vaww.va.gov/"
       CLASS="bodylink"
       TARGET="_top"
	   TITLE="Department of Veterans Affairs Intranet Home Page">
	   <ACRONYM TITLE="Department of Veterans Affairs">VA</ACRONYM>(Intranet)</A> /
				 
    <A HREF="http://vaww.vhaco.va.gov/vhacio/"
       CLASS="bodylink"
       TARGET="_top"
	   TITLE="Office of Information Home Page">
	   <ACRONYM TITLE="Office of Information">OI</ACRONYM></A> /
				 
    <A HREF="http://vista.med.va.gov/"
       CLASS="bodylink"
       TARGET="_top"
	   TITLE="Product Development (PD) Home Page">
	   <ACRONYM TITLE="Product Development">PD</ACRONYM></A> /

    <A HREF="http://vista.med.va.gov/iss/site_map.asp"
       CLASS="bodylink"
       TARGET="_top"
	   TITLE="Infrastructure & Security Services (ISS) Site Map">Site Map</A> /

    <A HREF="http://vista.med.va.gov/termsofuse.htm"
       CLASS="bodylink"
       TARGET="_top"
	   TITLE="Product Development (PD) Terms of Use Page">Terms of Use</A> /

    <A HREF="http://www.va.gov/privacy/"
       CLASS="bodylink"
       TARGET="_top"
	   TITLE="Department of Veterans Affairs Privacy Policy">VA Privacy Policy</A> /

    <A HREF="http://www1.va.gov/accessible/"
       CLASS="bodylink"
       TARGET="_top"
	   TITLE="Department of Veterans Affairs Internet Accessibility">Accessibility</A></P> 
  <!--webbot bot="Include" endspan i-checksum="53201" --><!--Date content was reviewed or updated--><P ALIGN="CENTER"> Reviewed/Updated: 
          
          <!--webbot bot="Timestamp"
          S-Type="REGENERATED" S-Format="%B %d, %Y" startspan -->June 18, 2018<!--webbot bot="Timestamp" endspan i-checksum="21789" -->
		  <BR>
		  <BR>
		  If you have questions, need more information, or are having
		  accessibility problems with this website, please contact us by E-Mail:
		  <A HREF="mailto:VHAISFCVTECH@med.va.gov?subject=Web page comments from: /kernel/apis/x-decode^xthcutl.shtml"
			 TITLE="Send mail to the Webmasters regarding this page">Webmasters</A>, Phone:
		  510-768-6800, or FAX: 510-768-6850.</P><P>&nbsp;</P>
	    </TD> 
      </TR> 
    </TABLE>
  </BODY></HTML>
